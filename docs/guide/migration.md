##MIGRATION GUIDE

This guide covers the migration of the application to another machine.

Are two ways to make the system migration. The quickest method (1) and the most time-consuming method (2).

####1. COPY METHOD

#####1.1 Copy all files

The quick backup method is copy all files from the current installation. Replace the #USER# and #HOST# with your user and old server address. After that, run the following command in your new server:

```
sudo rsync -a #USER#@#HOST#:/path/to/old/meican2 /path/to/new/meican2
```

#####1.2 Database

Now that you already have the files you need the database from the old machine. Follow the step 2.3 to get the backup and 2.7 to import the database on the new server.

Test your application accessing http://localhost and verify some pages. If you detect some wrong this method may not work in your system. In this case you should follow the method 2.

####2. NEW INSTALLATION METHOD

#####2.1 Backup of the certficate

Your new server will have the same domain? If yes, you need a backup of the all files from **certificates** folder.

#####2.2 Backup of the configurations

Backup the following files from **config** folder: "db.php", "mailer.php" and "params.php". 

#####2.3 Backup of the database

Export the MEICAN database. By default the database name is **meican2**. Overwrite #USER# and #PASS# with your credentials and execute this command:

```
mysqldump -u #USER# -p#PASS# --databases meican2 > backup.sql
```

#####2.4 Prepare the new environment

Following the installation guide respective, setup a complete new MEICAN instance on the new machine. IMPORTANT: make sure that the version of the new installation is **exacly** the same of the old server.

#####2.5 Copy the certificate

From the backup, copy the certificate to the **certificates** folder on the new server.

#####2.6 Copy the configuration

From the backup, copy the files: "db.php", "mailer.php" and "params.php" to the **config** folder on the new server.

#####2.7 Import the database

Access the MySQL terminal:

```
mysql -u #USER# -p#PASS#
```

Delete the database generated by the new installation of the step 4. 

```
DROP DATABASE IF EXISTS `meican2`;
```

Now, create a new database for receive the backup data obtained in the step 3.

```
CREATE DATABASE IF NOT EXISTS `meican2`;
```

After this, from the backup, import the database on the new machine. Out of the MySQL terminal run:

```
mysql -u #USER# -p#PASS# -h localhost meican2 < backup.sql
```

After all these steps, the migration is done. Commonly is required some changes on the old configurations.

Test your application accessing http://localhost
